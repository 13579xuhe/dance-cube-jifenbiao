<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>舞立方RAS比赛计分系统</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- 引入SheetJS库用于Excel导出 -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="css.css">
</head>
<body>
<div class="tech-grid"></div>

<div class="container glow-effect">
    <div class="header">
        <h1><i class="fas fa-trophy"></i> 舞立方RAS比赛计分系统</h1>
        <p>舞立方游戏地方比赛计分平台</p>
    </div>

    <div class="tabs">
        <div class="tab active" onclick="switchTab('signup')">
            <i class="fas fa-user-plus"></i> 选手签到
        </div>
        <div class="tab" onclick="switchTab('round1')">
            <i class="fas fa-filter"></i> 20晋8
        </div>
        <div class="tab" onclick="switchTab('round2')">
            <i class="fas fa-star"></i> 晋级赛
        </div>
        <div class="tab" onclick="switchTab('round3')">
            <i class="fas fa-chess-knight"></i> 排位赛
        </div>
        <div class="tab" onclick="switchTab('final')">
            <i class="fas fa-crown"></i> 决赛
        </div>
    </div>

    <!-- 在选手签到页面的已签到选手卡片前添加Excel导入卡片 -->
    <div class="card">
        <h3 class="card-title"><i class="fas fa-file-excel"></i> Excel批量导入</h3>
        <div class="form-group">
            <div class="input-field">
                <input type="file" id="excel-file" accept=".xlsx, .xls" style="color: #94a3b8;">
                <div id="file-error" class="error"></div>
            </div>
            <button class="btn btn-success" onclick="importFromExcel()">
                <i class="fas fa-file-import"></i> 导入Excel
            </button>
            <button class="btn btn-info" onclick="downloadTemplate()">
                <i class="fas fa-download"></i> 下载模板
            </button>
        </div>
        <p style="color: #94a3b8; font-size: 0.9rem; margin-top: 10px;">
            提示：Excel文件应包含"选手ID"和"选手昵称"两列，第一行为标题行
        </p>
    </div>

    <!-- 选手签到 -->
    <div id="signup" class="tab-content active">
        <!-- 内容保持不变 -->
        <div class="card rules">
            <h3 class="card-title"><i class="fas fa-info-circle"></i> 选手签到规则</h3>
            <p>请选手输入舞立方ID和昵称进行签到（ID只能输入数字）</p>
        </div>

        <div class="card">
            <h3 class="card-title"><i class="fas fa-user-edit"></i> 选手信息</h3>
            <div class="form-group">
                <div class="input-field">
                    <input type="text" id="player-id" placeholder="舞立方ID" pattern="\d*" oninput="validateNumberInput(this)">
                    <div id="id-error" class="error"></div>
                </div>
                <div class="input-field">
                    <input type="text" id="player-name" placeholder="选手昵称">
                </div>
                <button class="btn btn-primary" onclick="signupPlayer()">
                    <i class="fas fa-plus"></i> 添加选手
                </button>
            </div>
        </div>

        <div class="card">
            <h3 class="card-title"><i class="fas fa-list"></i> 已签到选手</h3>
            <table id="signup-table">
                <thead>
                <tr>
                    <th>序号</th>
                    <th>选手ID</th>
                    <th>选手昵称</th>
                    <th>操作</th>
                </tr>
                </thead>
                <tbody>
                <!-- 数据将通过JavaScript动态添加 -->
                </tbody>
            </table>

            <div class="controls">
                <button class="btn btn-success" onclick="startCompetition()">
                    <i class="fas fa-play"></i> 开始比赛
                </button>
                <button class="btn btn-danger" onclick="resetSignup()">
                    <i class="fas fa-trash"></i> 清空签到表
                </button>
                <button class="btn btn-danger" onclick="resetAllData()">
                    <i class="fas fa-broom"></i> 重置所有数据
                </button>
                <button class="btn btn-info" onclick="exportResults()">
                    <i class="fas fa-file-export"></i> 导出结果
                </button>
            </div>
        </div>
    </div>

    <!-- 20晋8 -->
    <div id="round1" class="tab-content">
        <!-- 内容保持不变 -->
        <div class="card rules">
            <h3 class="card-title"><i class="fas fa-info-circle"></i> 20晋8赛规</h3>
            <ul>
                <li>由主持人在海选歌单中随机抽取两首歌曲</li>
                <li>所有选手在比赛开始前抽好上场顺序（或按号码牌顺序），两人一组连续打完两首歌</li>
                <li>完成度相加累计前8名可进入下一轮</li>
            </ul>
        </div>

        <div class="controls">
            <button class="btn btn-success" onclick="calculateRound1()">
                <i class="fas fa-calculator"></i> 计算排名
            </button>
            <button class="btn btn-warning" onclick="proceedToRound2()">
                <i class="fas fa-arrow-right"></i> 进入晋级赛
            </button>
            <button class="btn btn-danger" onclick="resetRound1()">
                <i class="fas fa-redo"></i> 重置本轮
            </button>
            <button class="btn btn-info" onclick="exportResults()">
                <i class="fas fa-file-export"></i> 导出结果
            </button>
        </div>

        <div class="card">
            <h3 class="card-title"><i class="fas fa-table"></i> 20晋8比赛数据</h3>
            <table id="round1-table">
                <thead>
                <tr>
                    <th>序号</th>
                    <th>选手ID</th>
                    <th>选手昵称</th>
                    <th>第一首</th>
                    <th>第二首</th>
                    <th>总分</th>
                    <th>排名</th>
                </tr>
                </thead>
                <tbody>
                <!-- 数据将通过JavaScript动态添加 -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- 晋级赛 -->
    <div id="round2" class="tab-content">
        <!-- 内容保持不变 -->
        <div class="card rules">
            <h3 class="card-title"><i class="fas fa-info-circle"></i> 晋级赛赛规</h3>
            <ul>
                <li>由主持人在晋级赛歌单中随机抽取三首歌曲</li>
                <li>按海选赛排名领取号码牌，依次上机进行比赛</li>
                <li>完成度相加累计前4名可进入下一轮</li>
            </ul>
        </div>

        <div class="controls">
            <button class="btn btn-success" onclick="calculateRound2()">
                <i class="fas fa-calculator"></i> 计算排名
            </button>
            <button class="btn btn-warning" onclick="proceedToRound3()">
                <i class="fas fa-arrow-right"></i> 进入排位赛
            </button>
            <button class="btn btn-danger" onclick="resetRound2()">
                <i class="fas fa-redo"></i> 重置本轮
            </button>
            <button class="btn btn-info" onclick="exportResults()">
                <i class="fas fa-file-export"></i> 导出结果
            </button>
        </div>

        <div class="card">
            <h3 class="card-title"><i class="fas fa-table"></i> 晋级赛比赛数据</h3>
            <table id="round2-table">
                <thead>
                <tr>
                    <th>序号</th>
                    <th>选手ID</th>
                    <th>选手昵称</th>
                    <th>第一首</th>
                    <th>第二首</th>
                    <th>第三首</th>
                    <th>总分</th>
                    <th>排名</th>
                </tr>
                </thead>
                <tbody>
                <!-- 数据将通过JavaScript动态添加 -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- 排位赛 -->
    <div id="round3" class="tab-content">
        <!-- 内容保持不变 -->
        <div class="card rules">
            <h3 class="card-title"><i class="fas fa-info-circle"></i> 排位赛规则</h3>
            <ul>
                <li>由主持人从歌单中随机抽取一首歌曲</li>
                <li>四名选手在比赛开始前抽好上场顺序，两人一组连续打完一首歌</li>
                <li>四名选手按Perfect数排序，如Perfect数相同则比较总分</li>
            </ul>
        </div>

        <div class="controls">
            <button class="btn btn-success" onclick="calculateRound3()">
                <i class="fas fa-calculator"></i> 计算排名
            </button>
            <button class="btn btn-warning" onclick="proceedToFinal()">
                <i class="fas fa-arrow-right"></i> 进入决赛
            </button>
            <button class="btn btn-danger" onclick="resetRound3()">
                <i class="fas fa-redo"></i> 重置本轮
            </button>
            <button class="btn btn-info" onclick="exportResults()">
                <i class="fas fa-file-export"></i> 导出结果
            </button>
        </div>

        <div class="card">
            <h3 class="card-title"><i class="fas fa-table"></i> 排位赛比赛数据</h3>
            <table id="round3-table">
                <thead>
                <tr>
                    <th>序号</th>
                    <th>选手ID</th>
                    <th>选手昵称</th>
                    <th>歌曲</th>
                    <th>Perfect数</th>
                    <th>总分</th>
                    <th>排名</th>
                </tr>
                </thead>
                <tbody>
                <!-- 数据将通过JavaScript动态添加 -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- 决赛 -->
    <div id="final" class="tab-content">
        <!-- 内容保持不变 -->
        <div class="card rules">
            <h3 class="card-title"><i class="fas fa-info-circle"></i> 决赛规则</h3>
            <ul>
                <li>由主持人从歌单中随机抽取两首歌曲</li>
                <li>四名选手按总分从高到低排序</li>
            </ul>
        </div>

        <div class="controls">
            <button class="btn btn-success" onclick="calculateFinal()">
                <i class="fas fa-calculator"></i> 计算排名
            </button>
            <button class="btn btn-danger" onclick="resetFinal()">
                <i class="fas fa-redo"></i> 重置本轮
            </button>
            <button class="btn btn-info" onclick="exportResults()">
                <i class="fas fa-file-export"></i> 导出结果
            </button>
        </div>

        <div class="card">
            <h3 class="card-title"><i class="fas fa-table"></i> 决赛比赛数据</h3>
            <table id="final-table">
                <thead>
                <tr>
                    <th>序号</th>
                    <th>选手ID</th>
                    <th>选手昵称</th>
                    <th>第一首</th>
                    <th>第二首</th>
                    <th>总分</th>
                    <th>排名</th>
                </tr>
                </thead>
                <tbody>
                <!-- 数据将通过JavaScript动态添加 -->
                </tbody>
            </table>
        </div>
    </div>

    <div class="footer">
        <p>舞立方地方比赛计分系统 &copy; 2025 | 舞立方地方比赛计分平台</p>
    </div>
</div>

<!-- JavaScript代码 -->
<script src="js.js"></script>
</body>
</html>